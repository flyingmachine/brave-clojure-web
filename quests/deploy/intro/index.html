<!DOCTYPE HTML>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta path="/quests/deploy/intro/">
  
  <title>Intro | Parallel Programming in Clojure with Reducers</title>
  
  <link rel="stylesheet" href="/assets/stylesheets/main.css">
  <link rel="stylesheet" href="/assets/stylesheets/pygments.css">
  <link href="//fonts.googleapis.com/css?family=Roboto+Condensed:400,700italic,700,400italic,300italic,300%7CSource+Sans+Pro:400,200,200italic,300,300italic,400italic,600italic,600,700,700italic,900italic,900%7CSource+Code+Pro:400,700%7CGentium+Book+Basic:400,400italic,700,700italic%7CCourgette" rel="stylesheet" type="text/css">
</head>

  <body class="deploy-book">
    <div class="nav">
  <div class="container">
    <div>
      <ul>
        <li><a href="/">Brave Clojure</a></li>
        <li><a href="https://jobs.braveclojure.com">Jobs</a></li>
        <li><a href="http://open-source.braveclojure.com">Open Source Projects</a></li>
        <li><a href="/quests/deploy">Deployment Book</a></li>
        <li><a href="/quests/reducers/intro">Reducers Book</a></li>
        <li><a href="/training">On-Site Training</a></li>
      </ul>
    </div>
  </div>
</div>

    <div class="header">
      <div class="logoy">
        <div class="container">
          <div class="title">
            <a href="/quests/deploy">
              <strong>Deploying Your First Clojure App</strong>
            </a>
          </div>
          <div class="subtitle">
            ...From the Shadows
          </div>
        </div>
      </div>
    </div>
    <div class="callout">
      <div class="container">
        <form action="//flyingmachinestudios.us1.list-manage.com/subscribe/post?u=60763b0c4890c24bd055f32e6&amp;amp;id=0b40ffd1e1" class="validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
          <p>
            Follow
            <a href="https://twitter.com/nonrecursive">@nonrecursive</a>
            to hear about new content
            or subscribe:
            <input class="email" id="mce-EMAIL" name="EMAIL" placeholder="email address" required="" type="email" value="">
            <input class="button" id="mc-embedded-subscribe" name="subscribe" type="submit" value="get updates!">
          </p>
        </form>
      </div>
    </div>
    <div class="container wrap">
      <div class="main">
        <div class="chapter-nav">



<div class="prev"><a href="../preface/">← Preface</a></div>



<div class="next"><a href="../set-up-a-server-and-deploy-a-clojure-app-to-it/">Set Up a Server and Deploy a Clojure App to it →</a></div>


</div>

        <h1>Intro</h1>
<div class="paragraph">
<p>One of the first web sites I made was a Geocities-hosted compilation
of my highschool friends’ heads photoshopped on animal bodies that I
called <em>The Island of Dr. Schmoreau</em>. Because I was fifteen and dumb I
thought that showing it to a girl I had a crush on would endear me to
her, but instead she immediately burst into tears and stopped talking
to me for a week. This was naturally the most devastating thing that
had ever happened to poor, misunderstood me. However, once I was able
to pick myself up and stop listening to Metallica’s <em>Nothing Else
Matters</em> on repeat, I was able to appreciate the lesson that life had
handed me: <em>web development is an unprecedented tool for using dark,
weird, awkward creativity to sow chaos and madness.</em></p>
</div>
<div class="paragraph">
<p>Geocities was a great outlet for creativity because it had a
near-instantaneous <em>time to tears</em> (time it took for you to put
something you’d made online). If you graduate to making applications,
though, it can be confusing and time-consuming to figure out how to
deploy them.</p>
</div>
<div class="paragraph">
<p>Clojure applications are no exception.  Do you use Tomcat or a bare
uberjar or nginx with a reverse proxy? And heaven help you if you’re
new to the world of web apps and don’t even know to ask questions like
that. Navigating the modern hosting landscape can take hours, days — fortnights! — making it a serious creative barrier. Sometimes it can
be so frustrating that you’ll be tempted to give up and move on to
some other project. Chaos: unsown. Madness: uninflicted. Time spent
figuring out how to get a Clojure app online could be better spent
writing code or sharing your work and getting feedback.</p>
</div>
<div class="paragraph">
<p>I’ve written this guide because I want you to be able to easily share
your work and possibly make your soon-to-be-ex-friends cry. I’ve
assumed that you have no experience with deploying an application. By
the end, you’ll have the knowledge and tools to get your Clojure web
apps online quickly and easily. I’ve also tried to make this tutorial
a bit more than a step-by-step, purely practical howto guide; my hope
is that you’ll come away with a reasonable foundation in working with
servers, and that this will empower you to unleash your creative
endeavors (Clojure or otherwise) upon the unsuspecting populace.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">You’re also allowed to make money</div>
<div class="paragraph">
<p>Twice now I’ve mentioned web app deployment as being part of a larger
creative project. If your purpose in getting an app online is to make
a giant pile of cash, these tools will still work. They’re completely
agnostic to your intentions, your sense of self, your degree of
self-actualization, whether you like cats, whether in fact you prefer
dogs, the number of times you’ve fallen in love, and your high
school GPA. If you’ve found that any of these facets of your life have
impacted the functioning of these tools, please file an issue on
GitHub.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once you’ve downloaded a few tools, you’ll only need to run three
commands from the command line in order to set up and deploy to a
real, hosted Virtual Private Server (VPS); the tools will take care of
everything else. They’ll set up a single Ubuntu server by installing
nginx, java, and Datomic Free (postgres support is coming soon!). They
will copy your application as an uberjar and run it as an Upstart
service, and they’ll configure nginx to reverse-proxy requests to the
uberjar. (And I will explain what all of that means.)</p>
</div>
<div class="paragraph">
<p>Disclaimer: This tutorial assumes that you’re comfortable running
commands on the command line. If you don’t have much experience with
that, <a href="https://www.learnenough.com/command-line-tutorial">Learn Enough
Command Line to Be Dangerous</a> is a good, free tutorial. Also, I don’t
cover Windows because Ansible, the most important tool we’ll be using,
doesn’t work on Windows machines.</p>
</div>
<div class="paragraph">
<p>In Chapter 1, you’ll clone a fully-functioning example all-Clojure
single-page app that uses a Datomic database, and I’ll quickly walk
you through how to use some <em>Ansible roles</em> I’ve created to get the
application running on a server. You’ll learn how to test your setup
on a local <em>virtual machine</em> with <em>Vagrant</em>, and you’ll learn how to
deploy to a VPS hosted by Digital Ocean. You’ll get a full serving of
<em>what</em> to do with hardly any <em>why</em> it’s being done that way. If you
haven’t heard of Ansible or roles or virtual machines, don’t worry: I
will explain it all!</p>
</div>
<div class="paragraph">
<p>(In case you’re wondering, the example application uses ClojureScript
for the browser component, relying on Reagent and re-frame (don’t
worry if you haven’t heard of those) to render the user interface and
send AJAX requests to the backend. The backend uses Ring and Liberator
to service the frontend requests.)</p>
</div>
<div class="paragraph">
<p>Anyway: you’ll get a dose of <em>why</em> the deployment tools work the way
they do in Chapter 2, where you’ll be introduced to some basic DevOps
concepts. After that, the rest of Chapter 2 is dedicated to teaching
you Ansible basics. You’ll work with some example Ansible scripts
until you get a good foundation in working with Ansible; the
deployment tools consist almost entirely of Ansible scripts.</p>
</div>
<div class="paragraph">
<p>Chapter 3 is where we go through the scripts line by line so that
you’ll understand them as well as if you’d written them yourself, only
without all hours of yelling at and shaking your computer like a
madman that I went through in putting them together.  I’ll start by
taking a couple paragraphs to explain the approach I’ve taken in
developing the scripts — my <strong>philosophy</strong> of deployment scripting, if
you like abusing words. The goal is for you to be able to customize,
debug, and extend them. The scripts are very customizable, but
ultimately they’re tailored to my personal needs (hobby apps running
on a single Ubuntu server that have real users but that no one depends
on for the livelihood), and by the end of this guide I’d like you to
be able to use your new tools and knowledge to create something that
works for you.</p>
</div>
<div class="paragraph">
<p>Chapter 3 is also where you’ll learn about the different tools
involved (nginx and upstart, for example); you’ll learn about how to
use them individually, and how they work together. By learning about
these tools from the context of a working web application, you’ll
understand them better than if you read tutorials about how to use
each tool in isolation. <em>So dark! So powerful!</em></p>
</div>
<div class="paragraph">
<p>The deployment scripts were extracted from a really real project I
recently released, <a href="http://www.communitypicks.com">Community Picks</a>,
Community Picks is a site where redditors can share product
recommendations for their subreddits. (Anyone can browse, of course!)
Definitely check it out!  Hopefully it won’t make you cry. At the very
least, check out the <a href="http://www.communitypicks.com/r/clojure">Clojure
section</a>. I’m really hoping it becomes popular, and if you find this
tutorial helpful then one way you can express your shadowy
appreciation is to check out Community Picks and share it with other
people. Thanks a billion!</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Tales of Chaos and Madness <em>…​From the Shadows</em>
</div>
<div class="paragraph">
<p>If you ever want to give your spouse a good laugh, take the giant,
delicious cinnamon bun that she’s bought from Trader Joe’s and that
she’s asked you to save for her. Wait until she leaves for work at her
overnight job. Hide most of the cinnamon bun in a cabinet, leaving out
only a teeny tiny slice.</p>
</div>
<div class="paragraph">
<p>When your spouse comes home in the morning and shouts your name, come
into the kitchen and tell her that the cinnamon bun was <em>so good.</em>
Tell her that you just couldn’t resist, then take the “last piece”
and eat it in front of her. Everyone will love it!</p>
</div>
<div class="paragraph">
<p><em>So dark!</em></p>
</div>
</td>
</tr>
</table>
</div>
        <div class="chapter-nav">



<div class="prev"><a href="../preface/">← Preface</a></div>



<div class="next"><a href="../set-up-a-server-and-deploy-a-clojure-app-to-it/">Set Up a Server and Deploy a Clojure App to it →</a></div>


</div>

        <div id="disqus_thread"></div>
        <script>

          /**
          *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
          *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
          /*
          var disqus_config = function () {
          this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
          };
          */
          (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          s.src = 'https://clojureforthebraveandtrue.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
      </div>
      <div class="secondary">
        <div class="wrapper">
          <div class="junk">
            <script src="https://gumroad.com/js/gumroad.js"></script>
<a class="gumroad-button" href="https://gum.co/gHcWk" target="_blank">Buy the ebook!?</a>
          </div>
          <div class="ads">
            <a class="twitter-follow-button" href="https://twitter.com/nonrecursive">Follow @nonrecursive</a>
            <form action="//flyingmachinestudios.us1.list-manage.com/subscribe/post?u=60763b0c4890c24bd055f32e6&amp;amp;amp;id=0b40ffd1e1" class="validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
              <input class="email" id="mce-EMAIL" name="EMAIL" placeholder="email address" required="" type="email" value="">
              <input class="button" id="mc-embedded-subscribe" name="subscribe" type="submit" value="get email updates">
            </form>
            <ol>
              <li><a target="_blank" href="https://jobs.braveclojure.com">Find Clojure jobs</a></li>
              <li><a target="_blank" href="http://open-source.braveclojure.com">Contribute to beginner-friendly open source projects</a></li>
            </ol>
          </div>
          <div class="chapters">
            <div class="subtitle">Chapters</div>
            <ol class="toc">
              <li>
                <a href="/quests/deploy/preface/">
                  Preface
                </a>
              </li>
              <li>
                <a href="/quests/deploy/intro/">
                  Intro
                </a>
              </li>
              <li>
                <a href="/quests/deploy/set-up-a-server-and-deploy-a-clojure-app-to-it/">
                  Chapter 1: Set Up a Server and Deploy a Clojure App To It
                </a>
              </li>
              <li>
                <a href="/quests/deploy/ansible-tutorial/">
                  Chapter 2: An Ansible Tutorial
                </a>
              </li>
              <li>
                <a href="/quests/deploy/sweet-tooth-deep-dive/">
                  Chapter 3: Sweet Tooth Deep Dive
                </a>
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>
    <div class="footer">
      <div class="container">
        <div>
          © 2017 Daniel Higginbotham
        </div>
      </div>
    </div>
    <script id="dsq-count-scr" src="//clojureforthebraveandtrue.disqus.com/count.js" async></script>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="/assets/scripts/jquery.sticky.js"></script>
    <script src="/assets/scripts/sticky.js"></script>
    <script>
              !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs')
            </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-43463851-1', 'auto');
      ga('send', 'pageview');

    </script>
  </body>
</html>
